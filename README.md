# 股票爬虫评分系统

本系统从技术面出发，爬取所有股票最近30个交易日的数据，测算MACD、波动率、OBV、KDJ、当天涨幅、五日线、十日线等指标，对股票进行评分，导出为Excel文件，方便选股。同时支持历史数据回测，通过调整评分系统权重，优化选股效果。

## 爬虫部分

调用相关接口获取所有股票30个交易日的数据，计算当天涨幅、当天跌幅、MACD、波动率、OBV、KDJ、OBOS、RSI、市值、市盈率、市净率、所处板块等数据。

---

## 股票指标说明

### 1. MA（移动平均线）

**定义与作用：**  
反映股价在一段时间内的平均成本，平滑价格波动，常用于判断趋势方向。常见周期有5日、10日、20日、60日、120日、250日等。

**计算公式：**  
$$
MA = \frac{1}{N} \sum_{i=1}^{N} \text{Close}_i
$$

---

### 2. MACD（指数平滑异同移动平均线）

**定义与作用：**  
由快线DIF（短期EMA与长期EMA之差）、慢线DEA（DIF的EMA）和能量柱（快线减慢线）组成，用于判断趋势转折。常用参数为12、26、9。

**计算公式：**  
$$
\begin{align*}
DIF_t &= EMA_{x}(Close)_t - EMA_{y}(Close)_t \\
DEA_t &= EMA_{z}(DIF)_t \\
MACD_t &= 2 \times (DIF_t - DEA_t) \\
EMA_{n}(P)_t &= \alpha \cdot P_t + (1-\alpha) \cdot EMA_{n}(P)_{t-1},\quad \alpha = \frac{2}{n+1}
\end{align*}
$$

---

### 3. KDJ（随机指标）

**定义与作用：**  
通过最高价、最低价和收盘价计算K值、D值和J值，反映超买超卖状态和价格拐点。

**计算公式：**  
1. 计算未成熟随机值RSV：
   $$
   RSV_t = \frac{Close_t - Lowest_{N,t}}{Highest_{N,t} - Lowest_{N,t}} \times 100
   $$
2. 计算K、D、J值（常用N=9，M1=3，M2=3）：
   $$
   \begin{align*}
   K_t &= \frac{2}{3} K_{t-1} + \frac{1}{3} RSV_t \\
   D_t &= \frac{2}{3} D_{t-1} + \frac{1}{3} K_t \\
   J_t &= 3K_t - 2D_t
   \end{align*}
   $$
K值和D值一般在0-100之间，J值反映极端情况。

---

### 4. OBV（能量潮指标）

**定义与作用：**  
通过成交量与价格变动方向结合，累计每日成交量变化，用于判断资金流向和价格趋势的强弱。

**计算公式：**  
$$
OBV_t =
\begin{cases}
OBV_{t-1} + V_t, & \text{if } Close_t > Close_{t-1} \\
OBV_{t-1} - V_t, & \text{if } Close_t < Close_{t-1} \\
OBV_{t-1}, & \text{if } Close_t = Close_{t-1}
\end{cases}
$$
其中 $V_t$ 为当日成交量。

---

### 5. OBOS（超买超卖指标）

**定义与作用：**  
通过统计一段时间内上涨股票数与下跌股票数的差值，衡量市场整体的超买或超卖状态。OBOS值越大，市场越超买；OBOS值越小，市场越超卖。

**计算公式：**  
$$
OBOS = \sum_{i=1}^{N} \text{Up}_i - \sum_{i=1}^{N} \text{Down}_i
$$
其中 $\text{Up}_i$ 表示第 $i$ 天上涨股票数，$\text{Down}_i$ 表示第 $i$ 天下跌股票数。

---

### 6. RSI（相对强弱指数）

**定义与作用：**  
反映价格变动的速度和变化，常用于判断超买超卖状态。RSI值在0-100之间。

**计算公式：**  
1. 计算N日内收盘价上涨的总幅度A和下跌的总幅度B（取绝对值）  
2. 
$$
RSI = \frac{A}{A+B} \times 100
$$
其中，$A$ 为N日内所有上涨日的涨幅之和，$B$ 为N日内所有下跌日的跌幅之和。

---